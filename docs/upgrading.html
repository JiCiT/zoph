<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
    <head>
        <title>Zoph Documentation - Upgrading</title>
        <link TYPE="text/css" REL="stylesheet" HREF="style.css">
    </head>
    <body>
    <p>
    All text is available under the terms of the <a href="http://en.wikibooks.org/wiki/GNU_Free_Documentation_License">GNU Free Documentation License</a>. For the latest version of this document, see <a href="http://en.wikibooks.org/wiki/Zoph">Wikibooks</a>.
    </p>
<h1 id="firstHeading" class="firstHeading">Zoph/Upgrading</h1>
		<div id="bodyContent">
			<p>Upgrading Zoph is a relatively simple process; it consists of moving the php, javascript, language and image files into your web root (beware that you may want to keep your <tt>config.inc.php</tt>) and running an SQL script that makes the database changes. More details about this process and special instructions per version are described below.</p>
<table id="toc" class="toc">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Zoph_0.8_to_0.8.0.x"><span class="tocnumber">1</span> <span class="toctext">Zoph 0.8 to 0.8.0.x</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Zoph_0.8_to_0.8.1"><span class="tocnumber">2</span> <span class="toctext">Zoph 0.8 to 0.8.1</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Updating_the_database"><span class="tocnumber">2.1</span> <span class="toctext">Updating the database</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Configuration_updates"><span class="tocnumber">2.2</span> <span class="toctext">Configuration updates</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#New_options"><span class="tocnumber">2.2.1</span> <span class="toctext">New options</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Zoph_0.7_to_0.8"><span class="tocnumber">3</span> <span class="toctext">Zoph 0.7 to 0.8</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Updating_the_Database_2"><span class="tocnumber">3.1</span> <span class="toctext">Updating the Database</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Configuration_updates_2"><span class="tocnumber">3.2</span> <span class="toctext">Configuration updates</span></a>
<ul>
<li class="toclevel-3 tocsection-9"><a href="#New_options_2"><span class="tocnumber">3.2.1</span> <span class="toctext">New options</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-10"><a href="#Group_access_rights"><span class="tocnumber">3.3</span> <span class="toctext">Group access rights</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Zoph_0.7.x_to_0.8_update"><span class="tocnumber">4</span> <span class="toctext">Zoph 0.7.x to 0.8 update</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Zoph_0.7.5_or_0.8_pre-release_to_0.8"><span class="tocnumber">5</span> <span class="toctext">Zoph 0.7.5 or 0.8 pre-release to 0.8</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#Zoph_0.7_to_Zoph_0.7.0.x"><span class="tocnumber">6</span> <span class="toctext">Zoph 0.7 to Zoph 0.7.0.x</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Older_versions"><span class="tocnumber">7</span> <span class="toctext">Older versions</span></a></li>
</ul>
</td>
</tr>
</table>

<h2> <span class="mw-headline" id="Zoph_0.8_to_0.8.0.x">Zoph 0.8 to 0.8.0.x</span></h2>
<ul>
<li><i>You can also use these instructions to go from 0.8.0.1 to 0.8.0.2</i></li>
</ul>
<p>Copy php/* to the location of your installation. Make sure to also copy the php/lang subdirectory.</p>
<p>You can upgrade directly from 0.7 to 0.8.0.x, simply use the zoph-0.8.0.x.tar.gz and execute the instructions for the 0.7 to 0.8 upgrade.</p>
<h2> <span class="mw-headline" id="Zoph_0.8_to_0.8.1">Zoph 0.8 to 0.8.1</span></h2>
<ul>
<li>Follow the upgrade instructions to 0.8 first if you are using an older version. <i>(no need to really download and install v0.8, just execute the upgrade instructions)</i>.</li>
</ul>
<p>Copy <tt>php/*</tt> to the location of your installation. Make sure that you also copy the <tt>js</tt> and <tt>img</tt> subdirectories. If you use the translations in Zoph, make sure to also copy the <tt>lang</tt> directory.</p>
<h3> <span class="mw-headline" id="Updating_the_database">Updating the database</span></h3>
<p>Zoph 0.8.1 requires a manual upgrade to the database, this is described in <a href="changing_your_database_to_utf-8.html" title="Zoph/Upgrading/Changing your database to UTF-8">Changing your database to UTF-8</a>.</p>
<p>Execute zoph-update-0.8.sql:</p>
<pre>
mysql -u zoph_admin -p zoph &lt; sql/zoph_update-0.9.sql
</pre>
<p>Change <tt>zoph</tt> into <tt>zophutf8</tt> if you are working on the temporary database.</p>
<p>The database upgrade script makes the following changes:</p>
<ul>
<li>Make the language field in the prefs table longer so languages like en-ca can be stored (0.8.1)</li>
</ul>
<h3> <span class="mw-headline" id="Configuration_updates">Configuration updates</span></h3>
<p>(see <a href="configuration.html" title="Zoph/Configuration">Zoph/Configuration</a> for details):</p>
<h4> <span class="mw-headline" id="New_options">New options</span></h4>
<ul>
<li><a href="configuration.html#LOG_ALWAYS" title="Zoph/Configuration">Zoph/Configuration#LOG_ALWAYS</a> (0.8.1)</li>
<li><a href="configuration.html#LOG_SEVERITY" title="Zoph/Configuration">Zoph/Configuration#LOG_SEVERITY</a> (0.8.1)</li>
<li><a href="configuration.html#LOG_SUBJECT" title="Zoph/Configuration">Zoph/Configuration#LOG_SUBJECT</a> (0.8.1)</li>
</ul>
<h2> <span class="mw-headline" id="Zoph_0.7_to_0.8">Zoph 0.7 to 0.8</span></h2>
<ul>
<li><i>You can also use these instructions to go from 0.7.0.x to 0.8</i></li>
<li><i>For an update from 0.7.1, 0.7.2, 0.7.2.1, 0.7.3 or 0.7.4 see <a href="upgrading.html#Zoph_0.7.x_to_0.8_update" title="Zoph/Upgrading">0.7.x to 0.8</a></i></li>
<li><i>For an update from 0.7.5 or 0.8pre1 - 3, see <a href="upgrading.html#Zoph_0.7.5_or_0.8_pre-release_to_0.8" title="Zoph/Upgrading">Zoph 0.7.5 or 0.8 pre-release to 0.8</a></i></li>
</ul>
<p>Copy <tt>php/*</tt> to the location of your installation. Make sure that you also copy the <tt>js</tt> and <tt>img</tt> subdirectories. If you use the translations in Zoph, make sure to also copy the <tt>lang</tt> directory.</p>
<p>Copy bin/zophImport.pl into the directory where you installed it, if you followed the installation instructions it is probably <tt>/usr/local/bin</tt>, otherwise, find out with <tt>which zophImport.pl</tt>.</p>
<h3> <span class="mw-headline" id="Updating_the_Database_2">Updating the Database</span></h3>
<p>If you are upgrading from an older version than 0.7, please run the older database updates first.</p>
<p>Execute zoph-update-0.8.sql:</p>
<pre>
mysql -u zoph_admin -p zoph &lt; sql/zoph_update-0.8.sql
</pre>
<p>The database upgrade script makes the following changes:</p>
<ul>
<li>Add the 'sortname' column to the albums and categories tables (0.7.1)</li>
<li>Add preferences field to let users define the sort order (0.7.1)</li>
<li>Add a column to the users table that defines whether or not this user is allowed to download photos. (0.7.1)</li>
<li>Create tables zoph_pages, zoph_pageset and zoph_pages_pageset (0.72)</li>
<li>Add a 'pageset' field to zoph_albums, zoph_categories, zoph_places and zoph_people columns (0.7.2).</li>
<li>Add columns to the places and photos table to store the geographic location of that photo or place (0.7.3)</li>
<li>Add column to the places table to store timezone information (0.7.3)</li>
<li>Add column to the photos table to store time correction information (0.7.3)</li>
<li>Change the description column in the photos table from BLOB to TEXT, to improve search-capabilities (0.7.3)</li>
<li>Change the title field for albums and categories from 32 to 64 characters (0.7.3)</li>
<li>Add new tables for usergroups (0.7.4)</li>
<li>Modify the zoph_ratings table to allow multiple votes by the same user, store IP address and date/time (0.7.5)</li>
<li>Add an index on users to the zoph_ratings table (0.7.5)</li>
<li>Modify the zoph_users table to control whether a user is allowed to use the voting system and whether a user is allowed to vote multiple times on the same photo (0.7.5)</li>
<li>Create a table to store saved searches (0.7.5)</li>
</ul>
<h3> <span class="mw-headline" id="Configuration_updates_2">Configuration updates</span></h3>
<p>(see <a href="configuration.html" title="Zoph/Configuration">Zoph/Configuration</a> for details):</p>
<h4> <span class="mw-headline" id="New_options_2">New options</span></h4>
<ul>
<li><a href="configuration.html#MAPS" title="Zoph/Configuration">MAPS</a> (0.7.3)</li>
<li><a href="configuration.html#GOOGLE_KEY" title="Zoph/Configuration">GOOGLE_KEY</a> (0.7.3)</li>
<li><a href="configuration.html#CAMERA_TZ" title="Zoph/Configuration">CAMERA_TZ</a> (0.7.3)</li>
<li><a href="configuration.html#DATE_FORMAT" title="Zoph/Configuration">DATE_FORMAT</a> (0.7.3)</li>
<li><a href="configuration.html#TIME_FORMAT" title="Zoph/Configuration">TIME_FORMAT</a> (0.7.3)</li>
<li><a href="configuration.html#GUESS_TZ" title="Zoph/Configuration">GUESS_TZ</a> (0.7.3)</li>
<li><a href="configuration.html#ICONSET" title="Zoph/Configuration">ICONSET</a> (0.7.2)</li>
<li><a href="configuration.html#DEFAULT_LANG" title="Zoph/Configuration">DEFAULT_LANG</a> (0.7.2)</li>
<li><a href="configuration.html#WM_POSX" title="Zoph/Configuration">WM_POSX</a> (0.7.1)</li>
<li><a href="configuration.html#WM_POSY" title="Zoph/Configuration">WM_POSY</a> (0.7.1)</li>
<li><a href="configuration.html#WM_TRANS" title="Zoph/Configuration">WM_TRANS</a> (0.7.1)</li>
<li><a href="configuration.html#IMPORT_MOVE" title="Zoph/Configuration">IMPORT_MOVE</a> (0.7.1)</li>
<li><a href="configuration.html#DOWNLOAD" title="Zoph/Configuration">DOWNLOAD</a> (0.7.1)</li>
</ul>
<h3> <span class="mw-headline" id="Group_access_rights">Group access rights</span></h3>
<p>As of Zoph 0.7.4, you have to make your users members of a group and then assign viewing rights for albums to the group, instead of to the users directly. After the update to 0.7.4, you will have no groups and therefore your users will not be allowed to see any photos, you should create one or more groups, make your user member of one or more of them and assign viewing rights to the groups. If you'd rather stay with your current per-user viewing rights, you can use the <tt>user_to_group.php</tt> script in the <tt>contrib</tt> directory: this will create a new group for each user and assign the currently defined access rights for each user the newly created groups. To use this script:</p>
<ol>
<li>Make a backup of your current Zoph database;</li>
<li>Copy the <tt>users_to_group.php</tt> script into your Zoph php directory;</li>
<li>Log in to Zoph with an admin user;</li>
<li>Did I mention making a backup?</li>
<li>Change the part after the last <tt>/</tt> in your browser into <tt>user_to_group.php</tt>;</li>
</ol>
<p>After this, you can remove the <tt>zoph_album_permissions</tt> table in Zoph, as it is no longer used.</p>
<h2> <span class="mw-headline" id="Zoph_0.7.x_to_0.8_update">Zoph 0.7.x to 0.8 update</span></h2>
<ul>
<li><i>Except 0.7.5, see <a href="http://en.wikibooks.orgupgrading.html#Zoph_0.7.5_or_0.8_pre-release_to_0.8" class="external text" rel="nofollow">Zoph 0.7.5 or 0.8 pre-release to 0.8</a></i></li>
</ul>
<p>If you have previously upgraded to a feature release (0.7.1, 0.7.2, 0.7.3 or 0.7.4), you need to edit <tt>zoph-update-0.8.sql</tt>. You should comment out the changes that have already been applied to your system. For example, if you are upgrading from 0.7.1 to 0.8, you will need to prepend the changes for 0.7.1 with a <tt>#</tt>, since you have already applied those changes when you updated to 0.7.1. After that, you can follow the instructions for 0.7 to 0.8</p>
<h2> <span class="mw-headline" id="Zoph_0.7.5_or_0.8_pre-release_to_0.8">Zoph 0.7.5 or 0.8 pre-release to 0.8</span></h2>
<p>If you are upgrading from 0.7.5 or or a 0.8 pre-release to 0.8, you don't need to run any database scripts, there are no database changes in this upgrade.</p>
<p>Follow the instructions for 0.7 to 0.8, but skip the database upgrades.</p>
<h2> <span class="mw-headline" id="Zoph_0.7_to_Zoph_0.7.0.x">Zoph 0.7 to Zoph 0.7.0.x</span></h2>
<p>Copy php/* to the location of your installation. Make sure to also copy the php/lang subdirectory.</p>
<p>You can upgrade directly from 0.6 to 0.7.0.x, simply use the zoph-0.7.0.x.tar.gz and execute the instructions for the 0.6 to 0.7 upgrade.</p>
<h2> <span class="mw-headline" id="Older_versions">Older versions</span></h2>
<p>For upgrades from an older version of Zoph: <a href="/wiki/Zoph/Archive" title="Zoph/Upgrading/Archive">Zoph/Upgrading/Archive</a></p>





</div>
</html>
