<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
    <head>
        <title>Zoph Documentation - Installation</title>
        <link TYPE="text/css" REL="stylesheet" HREF="style.css">
    </head>
    <body>
    <p>
    All text is available under the terms of the <a href="http://en.wikibooks.org/wiki/GNU_Free_Documentation_License">GNU Free Documentation License</a>. For the latest version of this document, see <a href="http://en.wikibooks.org/wiki/Zoph">Wikibooks</a>.
    </p>
<h1 id="firstHeading" class="firstHeading">Zoph/Installation</h1>
		<div id="bodyContent">
			<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#Requirements"><span class="tocnumber">1</span> <span class="toctext">Requirements</span></a></li>
<li class="toclevel-1"><a href="#Creating_the_database"><span class="tocnumber">2</span> <span class="toctext">Creating the database</span></a>
<ul>
<li class="toclevel-2"><a href="#Create_a_database_and_import_the_tables"><span class="tocnumber">2.1</span> <span class="toctext">Create a database and import the tables</span></a></li>
<li class="toclevel-2"><a href="#Create_users_for_zoph"><span class="tocnumber">2.2</span> <span class="toctext">Create users for zoph</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Configure_the_PHP_templates"><span class="tocnumber">3</span> <span class="toctext">Configure the PHP templates</span></a></li>
<li class="toclevel-1"><a href="#Install_the_templates"><span class="tocnumber">4</span> <span class="toctext">Install the templates</span></a>
<ul>
<li class="toclevel-2"><a href="#Pick_a_location_to_put_Zoph"><span class="tocnumber">4.1</span> <span class="toctext">Pick a location to put Zoph</span></a></li>
<li class="toclevel-2"><a href="#Copy_the_templates"><span class="tocnumber">4.2</span> <span class="toctext">Copy the templates</span></a></li>
<li class="toclevel-2"><a href="#Set_accessrights"><span class="tocnumber">4.3</span> <span class="toctext">Set accessrights</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Install_the_perl_scripts"><span class="tocnumber">5</span> <span class="toctext">Install the perl scripts</span></a>
<ul>
<li class="toclevel-2"><a href="#Check_the_path_to_perl"><span class="tocnumber">5.1</span> <span class="toctext">Check the path to perl</span></a></li>
<li class="toclevel-2"><a href="#Configure_the_database_variables"><span class="tocnumber">5.2</span> <span class="toctext">Configure the database variables</span></a></li>
<li class="toclevel-2"><a href="#Copy_bin.2FzophImport.pl_and_bin.2FzophExport.pl_to_.2Fusr.2Flocal.2Fbin"><span class="tocnumber">5.3</span> <span class="toctext">Copy bin/zophImport.pl and bin/zophExport.pl to /usr/local/bin</span></a></li>
<li class="toclevel-2"><a href="#Install_the_man_page"><span class="tocnumber">5.4</span> <span class="toctext">Install the man page</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Test_it"><span class="tocnumber">6</span> <span class="toctext">Test it</span></a></li>
</ul>
</td>
</tr>
</table>

<p><a name="Requirements" id="Requirements"></a></p>
<h2> <span class="mw-headline">Requirements</span></h2>
<p>First, make sure you meet all the requirements in the <a href="requirements.html" title="Zoph/Requirements">previous chapter</a>.</p>
<p><a name="Creating_the_database" id="Creating_the_database"></a></p>
<h2> <span class="mw-headline">Creating the database</span></h2>
<p><a name="Create_a_database_and_import_the_tables" id="Create_a_database_and_import_the_tables"></a></p>
<h3> <span class="mw-headline">Create a database and import the tables</span></h3>
<pre>
$ mysqladmin -u root -p create zoph
$ mysql -u root -p zoph &lt; sql/zoph.sql
</pre>
<p><a name="Create_users_for_zoph" id="Create_users_for_zoph"></a></p>
<h3> <span class="mw-headline">Create users for zoph</span></h3>
<p>I created two users: zoph_rw is used by the application and zoph_admin is used when I work directly in mysql so I don't have to use root.</p>
<pre>
$ mysql -u root -p
mysql&gt; grant select, insert, update, delete on zoph.* to zoph_rw@localhost identified by 'PASSWORD';
</pre>
<pre>
mysql&gt; grant all on zoph.* to zoph_admin identified by 'PASSWORD';
</pre>
<p><a name="Configure_the_PHP_templates" id="Configure_the_PHP_templates"></a></p>
<h2> <span class="mw-headline">Configure the PHP templates</span></h2>
<p>Please see <a href="configuration.html" title="Zoph/Configuration">the chapter on configuration</a> for details.</p>
<p><a name="Install_the_templates" id="Install_the_templates"></a></p>
<h2> <span class="mw-headline">Install the templates</span></h2>
<p><a name="Pick_a_location_to_put_Zoph" id="Pick_a_location_to_put_Zoph"></a></p>
<h3> <span class="mw-headline">Pick a location to put Zoph</span></h3>
<p>Create a zoph/ directory off the doc root of your web server, or create a Virtual Host with a new doc root.</p>
<pre>
$ mkdir /var/www/html/zoph
</pre>
<p><a name="Copy_the_templates" id="Copy_the_templates"></a></p>
<h3> <span class="mw-headline">Copy the templates</span></h3>
<pre>
$ cp -r php/* /var/www/html/zoph/
</pre>
<p><a name="Set_accessrights" id="Set_accessrights"></a></p>
<h3> <span class="mw-headline">Set accessrights</span></h3>
<p>For better security, you probably want to set accessrights on your Zoph files. (You may want to do this after testing whether Zoph works, in that case you know what caused it when it seizes working after this change)</p>
<p>First, you need to figure out which user Apache is running under. Usually this is <tt>apache</tt> for both user and group. To determine this, check <tt>httpd.conf</tt> or use</p>
<pre>
ps -ef | grep httpd
</pre>
<p>You should probably make all files owned by the user <tt>apache</tt> and the group <tt>apache</tt>. You can do than with</p>
<pre>
chown -R apache:apache /var/www/html/zoph 
</pre>
<p><br />
You can either make them only readable by this user/group (more security): <b>440</b>, readable by all users: <b>444</b>, or readable and writable by all users: <b>666</b>. The last case means that you don't need root access to edit config.inc.php or to make changes to the other php files (such as upgrades to a new version). Keep in mind that your mysql password is in config.inc.php, so if you've users on your system that are not allowed to know it, you should choose the first option. The directories should have execute rights: <b>550</b> for max security or <b>777</b> for access for all users.</p>
<p>To do this, first go to the directory directly above your Zoph directory, in this example /var/www/html</p>
<pre>
cd /var/www/html
chmod [dir] zoph
cd zoph
find -type f | xargs chmod [file]
find -type -d | xargs chmod [dir]
</pre>
<p>replace [dir] with the accesspattern you've chosen for directories above and replace [file] with the one for files.</p>
<div style="width:50%; background:#FFFF66; color:black; border:1px solid black; margin:auto; font-weight:normal;">
<div style="color:red; font-size-adjust:0.5; margin:0.75em; text-align:center;"><b>Important!</b></div>
<div>
<p>Double check whether you are using the correct directory and if you have typed it correctly, if you would accidently type "/[space]var/www/html/zoph" or something, you would change all files on your <b>entire</b> system to <tt>apache</tt>/<tt>apache</tt> as owner - not good).</p>
</div>
</div>
<p><a name="Install_the_perl_scripts" id="Install_the_perl_scripts"></a></p>
<h2> <span class="mw-headline">Install the perl scripts</span></h2>
<p><a name="Check_the_path_to_perl" id="Check_the_path_to_perl"></a></p>
<h3> <span class="mw-headline">Check the path to perl</span></h3>
<p>The perl scripts points to /usr/bin/perl. If your perl is in a different place, edit the first line of the script.</p>
<p><a name="Configure_the_database_variables" id="Configure_the_database_variables"></a></p>
<h3> <span class="mw-headline">Configure the database variables</span></h3>
<p>Edit <tt>zophrc.sample</tt> (in the <tt>bin</tt> directory of the Zoph tar.gz) so that the following variables match the values you put in config.inc.php:</p>
<pre>
$db_host = 'localhost';
$db_name = 'zoph';
$db_user = 'zoph_rw';
$db_pass = 'pass';
$db_prefix = 'zoph_';
</pre>
<pre>
$image_dir = '/data/images/';
</pre>
<p>And then move this file to the home directory of the user you are planning on using to import photo's. Probably your own home directory. Save it under the name <tt>.zophrc</tt>.</p>
<p>You can also set some defaults in this file, in this way you do not need to always provide these commandline arguments:</p>
<pre>
$datedDirs = 0;
$copy = 0;
$hierarchical = 0;
$verbose = 0;
$resolveSymlinks = 0;
</pre>
<p>Make sure the file ends with</p>
<pre>
1;
</pre>
<p>Because Perl does not like it when the last assignment of the file is negative.</p>
<p><a name="Copy_bin.2FzophImport.pl_and_bin.2FzophExport.pl_to_.2Fusr.2Flocal.2Fbin" id="Copy_bin.2FzophImport.pl_and_bin.2FzophExport.pl_to_.2Fusr.2Flocal.2Fbin"></a></p>
<h3> <span class="mw-headline">Copy bin/zophImport.pl and bin/zophExport.pl to /usr/local/bin</span></h3>
<p>Or some other directory in your PATH.</p>
<p><a name="Install_the_man_page" id="Install_the_man_page"></a></p>
<h3> <span class="mw-headline">Install the man page</span></h3>
<p>A man page for zophImport.pl is in the man/ directory. Copy this to somewhere in your manpath, /usr/local/man/man1 for example.</p>
<p><a name="Test_it" id="Test_it"></a></p>
<h2> <span class="mw-headline">Test it</span></h2>
<p>Try hitting <a href="http://localhost/zoph/logon.php" class="external free" title="http://localhost/zoph/logon.php" rel="nofollow">http://localhost/zoph/logon.php</a>. You should be presented with the logon screen. Log in using "admin" for user and "admin" for password.</p>
<p>If you get a 404 error...</p>
<ul>
<li>make sure the zoph/ folder and templates can be seen by the web server.</li>
</ul>
<p>If you see a bunch of code...</p>
<ul>
<li>make sure Apache is configured to handle PHP
<ul>
<li>The Apache configuration needs to contain this:</li>
</ul>
</li>
</ul>
<pre>
LoadModule php5_module /usr/lib/apache2/modules/libphp5.so
AddType application/x-httpd-php .php
</pre>
<p>If you see a MySQL access denied error...</p>
<ul>
<li>make sure the DB_USER you specified in config.inc.php actually has access to the database. If your database is not on localhost, you will need to grant permissions to zoph_rw@hostname for that host.</li>
</ul>





</div>
</html>
